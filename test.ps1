function Test-MatrixDeterminant {
    param (
        [int]$size,
        [double[][]]$matrix,
        [double]$expectedDet,
        [int]$timeLimit
    )

    if(!($matrix.Length -eq $matrix[0].Length -And $matrix.Length -eq $size)){
        Write-Host "Problematic Element Found !" -ForegroundColor Red
        return -1
    }

    $filePath = Join-Path (Get-Location).Path "build\Debug\MatrixDeterminantCalculator.exe"

     $processInfo = New-Object System.Diagnostics.ProcessStartInfo
     $processInfo.FileName = $filePath
     $processInfo.RedirectStandardInput = $true
     $processInfo.RedirectStandardOutput = $true
     $processInfo.RedirectStandardError = $true
     $processInfo.UseShellExecute = $false
     $processInfo.CreateNoWindow = $false
 
     $process = New-Object System.Diagnostics.Process
     $process.StartInfo = $processInfo
 
     #Write-Host "Process Started"
     $process.Start() | Out-Null
     #$process.BeginOutputReadLine()
     
     $process.StandardInput.WriteLine("$size")
     $process.StandardInput.WriteLine("$size")

     for ($row = 0; $row -lt $size; $row++) {
        for ($col = 0; $col -lt $size; $col++) {
            #Write-Host "Sending value: $($matrix[$row][$col])"
            $process.StandardInput.WriteLine($matrix[$row][$col])
        }
    }

    $process.StandardInput.WriteLine("0")

    #while (-not $process.HasExited){
    #    Start-Sleep -Milliseconds 50
    #}
     Write-Host "Process Exited, Analyzing Result"
     $output = $process.StandardOutput.ReadToEnd()
     Write-Host "Output: $output"
     $err = $process.StandardError.ReadToEnd()
     Write-Host "Error Output: $err" 
    
    $process.WaitForExit($timeLimit) | Out-Null
 


     if($output -match "Determinant of the matrix is (\-?\d+(\.\d+)?)"){
        $resultDet = [double]$matches[1]
        if ($resultDet -eq $expectedDet) {
            Write-Host "Test passed. Expected determinant: $expectedDet, Calculated determinant: $resultDet" -ForegroundColor Green
            return 1
        } else {
            Write-Host "Test failed. Expected determinant: $expectedDet, Calculated determinant: $resultDet" -ForegroundColor Red
        }
     }
     else{
        Write-Host "Test failed. App didn't returned a result." -ForegroundColor Red
     }
     #$process.Kill() | Out-Null

     return 0
}

# Test Dataset
$tests = @(
    @{
        size = 2
        matrix = @(
            @(2, 3),
            @(1, 4)
        )
        expectedDet = 5
    },
    @{
        size = 2
        matrix = @(
            @(4, 7),
            @(2, 6)
        )
        expectedDet = 10
    },
    @{
        size = 2
        matrix = @(
            @(5, 1),
            @(3, 2)
        )
        expectedDet = 7
    },
    @{
        size = 3
        matrix = @(
            @(1, 2, 3),
            @(4, 5, 6),
            @(7, 8, 9)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(3, 2, 1),
            @(6, 5, 4),
            @(9, 8, 7)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1, 0, 0),
            @(0, 3, 0),
            @(0, 0, 5)
        )
        expectedDet = 15
    },
    @{
        size = 2
        matrix = @(
            @(2, 1),
            @(1, 2)
        )
        expectedDet = 3
    },
    @{
        size = 2
        matrix = @(
            @(5, 7),
            @(3, 8)
        )
        expectedDet = 19
    },
    @{
        size = 3
        matrix = @(
            @(1, 2, 1),
            @(3, 4, 2),
            @(5, 6, 3)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1, 1, 1),
            @(2, 2, 2),
            @(3, 3, 3)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(1, 2, 3, 4),
            @(5, 6, 7, 8),
            @(9, 10, 11, 12),
            @(13, 14, 15, 16)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(2, 4, 1, 3),
            @(1, 3, 2, 4),
            @(3, 2, 4, 1),
            @(4, 1, 3, 2)
        )
        expectedDet = 80
    },
    @{
        size = 5
        matrix = @(
            @(1, 2, 3, 4, 5),
            @(6, 7, 8, 9, 10),
            @(11, 12, 13, 14, 15),
            @(16, 17, 18, 19, 20),
            @(21, 22, 23, 24, 25)
        )
        expectedDet = 0
    },
    @{
        size = 5
        matrix = @(
            @(3, 1, 4, 1, 5),
            @(9, 2, 6, 5, 3),
            @(5, 8, 9, 7, 9),
            @(3, 4, 2, 5, 6),
            @(7, 1, 6, 8, 2)
        )
        expectedDet = -4115
    },
    @{
        size = 6
        matrix = @(
            @(1, 1, 1, 1, 1, 1),
            @(1, 2, 2, 2, 2, 2),
            @(1, 2, 3, 3, 3, 3),
            @(1, 2, 3, 4, 4, 4),
            @(1, 2, 3, 4, 5, 5),
            @(1, 2, 3, 4, 5, 6)
        )
        expectedDet = 1
    },
    @{
        size = 6
        matrix = @(
            @(2, 3, 1, 4, 5, 6),
            @(7, 8, 9, 1, 2, 3),
            @(4, 5, 6, 7, 8, 9),
            @(3, 1, 2, 8, 6, 4),
            @(1, 2, 3, 4, 5, 6),
            @(7, 8, 9, 1, 2, 3)
        )
        expectedDet = 0
    },
    @{
        size = 2
        matrix = @(
            @(1, 1),
            @(1, 1)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1, 1, 1),
            @(1, 1, 1),
            @(1, 1, 1)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(1, 1, 1, 1),
            @(2, 2, 2, 2),
            @(3, 3, 3, 3),
            @(4, 4, 4, 4)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1, 2, 3),
            @(4, 5, 6),
            @(7, 8, 9)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(1, 2, 3, 4),
            @(1, 2, 3, 5),
            @(1, 2, 3, 6),
            @(1, 2, 3, 7)
        )
        expectedDet = 0
    },
    @{
        size = 5
        matrix = @(
            @(5, 1, 2, 3, 4),
            @(0, 6, 7, 8, 9),
            @(1, 0, 6, 7, 8),
            @(2, 1, 0, 6, 7),
            @(3, 2, 1, 0, 6)
        )
        expectedDet = 5625
    },
    @{
        size = 3
        matrix = @(
            @(0, 10, 20),
            @(30, 0, 40),
            @(50, 60, 0)
        )
        expectedDet = 56000
    },
    @{
        size = 1
        matrix = @(
            @(1) 
        )
        expectedDet = 1
    },
    @{
        size = 1
        matrix = @(
            @(5) 
        )
        expectedDet = 5
    },
    @{
        size = 1
        matrix = @(
            @(9)
        )
        expectedDet = 9
    },
    @{
        size = 1
        matrix = @(
            @(-10)
        )
        expectedDet = -10
    },
    @{
        size = 1
        matrix = @(
            @(-45)
        )
        expectedDet = -45
    },
    @{
        size = 1
        matrix = @(
            @(-27)
        )
        expectedDet = -27
    },
    @{
        size = 1
        matrix = @(
            @(5000)
        )
        expectedDet = 5000
    },
    @{
        size = 1
        matrix = @(
            @(96754)
        )
        expectedDet = 96754
    },
    @{
        size = 1
        matrix = @(
            @(150)
        )
        expectedDet = 150
    },
    @{
        size = 2
        matrix = @(
            @(1,3),
            @(2,4)
        )
        expectedDet = -2
    },
    @{
        size = 2
        matrix = @(
            @(2,2),
            @(2,2)
        )
        expectedDet = 0
    },
    @{
        size = 2
        matrix = @(
            @(4,8),
            @(2,4)
        )
        expectedDet = 0
    },
    @{
        size = 2
        matrix = @(
            @(-3,-7),
            @(5,4)
        )
        expectedDet = 23
    },
    @{
        size = 2
        matrix = @(
            @(-1,-2),
            @(-5,-1)
        )
        expectedDet = -9
    },
    @{
        size = 2
        matrix = @(
            @(-9,3),
            @(-9,3)
        )
        expectedDet = 0
    },
    @{
        size = 2
        matrix = @(
            @(100,200),
            @(50,40)
        )
        expectedDet = -6000
    },
    @{
        size = 2
        matrix = @(
            @(40,578),
            @(20,1000)
        )
        expectedDet = 28440
    },
    @{
        size = 2
        matrix = @(
            @(123,123),
            @(40,200)
        )
        expectedDet = 19680
    },
    @{
        size = 3
        matrix = @(
            @(1,2,3),
            @(4,5,6),
            @(7,8,9)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1,2,3),
            @(2,3,1),
            @(3,1,2)
        )
        expectedDet = -18
    },
    @{
        size = 3
        matrix = @(
            @(4,5,7),
            @(8,4,2),
            @(6,3,0)
        )
        expectedDet = 36
    },
    @{
        size = 3
        matrix = @(
            @(4,0,0),
            @(3,6,0),
            @(1,3,5)
        )
        expectedDet = 120
    },
    @{
        size = 3
        matrix = @(
            @(5,6,3),
            @(0,6,1),
            @(0,0,7)
        )
        expectedDet = 210
    },
    @{
        size = 3
        matrix = @(
            @(3,0,0),
            @(0,2,0),
            @(0,0,1)
        )
        expectedDet = 6
    },
    @{
        size = 3
        matrix = @(
            @(4,0,0),
            @(0,5,0),
            @(0,0,0)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(2,2,2),
            @(3,3,3),
            @(4,4,4)
        )
        expectedDet = 0
    },
    @{
        size = 3
        matrix = @(
            @(1,6,1),
            @(6,9,6),
            @(1,6,1)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(3,4,5,1),
            @(6,4,7,8),
            @(3,5,0,9),
            @(2,1,5,3)
        )
        expectedDet = 321
    },
    @{
        size = 4
        matrix = @(
            @(4,7,1,9),
            @(5,3,3,2),
            @(1,5,2,8),
            @(9,7,5,3)
        )
        expectedDet = 201
    },
    @{
        size = 4
        matrix = @(
            @(5,6,3,8),
            @(4,6,2,9),
            @(8,5,6,4),
            @(2,4,1,1)
        )
        expectedDet = 9
    },
    @{
        size = 4
        matrix = @(
            @(1,2,3,4),
            @(2,3,4,1),
            @(3,4,1,2),
            @(4,1,2,3)
        )
        expectedDet = 160
    },
    @{
        size = 4
        matrix = @(
            @(9,8,7,6),
            @(1,2,3,4),
            @(4,5,6,7),
            @(6,5,4,3)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(2,2,3,3),
            @(4,4,5,5),
            @(6,6,7,7),
            @(8,8,9,9)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(1,5,2,6),
            @(2,6,3,7),
            @(3,7,4,8),
            @(4,8,5,9)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(1,5,2,6),
            @(2,6,3,7),
            @(3,7,4,8),
            @(4,8,5,9)
        )
        expectedDet = 0
    },
    @{
        size = 4
        matrix = @(
            @(5,5,4,3),
            @(2,3,3,4),
            @(3,3,4,4),
            @(3,4,5,5)
        )
        expectedDet = -10
    },
    @{
        size = 4
        matrix = @(
            @(4,5,3,8),
            @(2,5,7,3),
            @(6,4,3,3),
            @(1,1,8,6)
        )
        expectedDet = 1053
    },
    @{
        size = 5
        matrix = @(
            @(2,5,4,8,6),
            @(7,3,2,0,5),
            @(4,5,4,8,9),
            @(2,3,5,0,1),
            @(4,5,8,5,3)
        )
        expectedDet = -921
    },
    @{
        size = 5
        matrix = @(
            @(3,4,6,7,8),
            @(1,5,9,8,0),
            @(3,5,6,8,7),
            @(4,1,8,6,0),
            @(9,4,3,1,8)
        )
        expectedDet = 2889
    },
    @{
        size = 5
        matrix = @(
            @(1,9,5,7,1),
            @(4,5,3,4,6),
            @(2,5,6,0,9),
            @(4,7,6,6,1),
            @(8,0,0,4,3)
        )
        expectedDet = -204
    },
    @{
        size = 5
        matrix = @(
            @(3,0,0,0,0),
            @(4,2,0,0,0),
            @(2,5,1,0,0),
            @(1,7,6,2,0),
            @(2,0,5,7,3)
        )
        expectedDet = 36
    },
    @{
        size = 5
        matrix = @(
            @(1,0,0,0,0),
            @(4,1,0,0,0),
            @(3,5,1,0,0),
            @(2,6,6,1,0),
            @(5,6,6,1,1)
        )
        expectedDet = 1
    },
    @{
        size = 5
        matrix = @(
            @(1,2,3,4,5),
            @(2,3,4,5,6),
            @(3,4,5,6,7),
            @(4,5,6,7,8),
            @(5,6,7,8,9)
        )
        expectedDet = 0
    },
    @{
        size = 5
        matrix = @(
            @(1,2,3,4,5),
            @(2,3,4,5,1),
            @(3,4,5,1,2),
            @(4,5,1,2,3),
            @(5,1,2,3,4)
        )
        expectedDet = 1875
    },
    @{
        size = 5
        matrix = @(
            @(0,1,2,3,4),
            @(0,3,5,7,9),
            @(0,5,7,8,9),
            @(4,5,1,2,3),
            @(0,5,6,7,4)
        )
        expectedDet = 16
    },
    @{
        size = 5
        matrix = @(
            @(0,0,3,0,0),
            @(3,5,3,6,5),
            @(6,5,3,7,8),
            @(1,5,3,7,8),
            @(8,6,3,8,7)
        )
        expectedDet = 105
    },
    @{
        size = 6
        matrix = @(
            @(3,5,3,7,6,7),
            @(6,4,9,8,0,1),
            @(2,1,4,3,6,9),
            @(6,9,5,3,1,3),
            @(6,3,8,5,9,7),
            @(4,6,7,3,2,5)
        )
        expectedDet = -28197
    },
    @{
        size = 6
        matrix = @(
            @(2,4,5,4,3,7),
            @(3,6,1,2,2,5),
            @(5,7,3,4,5,4),
            @(7,5,4,4,1,2),
            @(4,7,5,3,8,8),
            @(5,4,7,0,1,2)
        )
        expectedDet = -7238
    },
    @{
        size = 6
        matrix = @(
            @(3,6,4,9,7,1),
            @(4,5,6,2,8,5),
            @(9,4,5,6,1,2),
            @(1,1,2,3,5,8),
            @(7,2,2,1,6,6),
            @(3,6,7,3,2,1)
        )
        expectedDet = 20622
    },
    @{
        size = 6
        matrix = @(
            @(1,2,3,4,5,6),
            @(2,3,4,5,6,1),
            @(3,4,5,6,1,2),
            @(4,5,6,1,2,3),
            @(5,6,1,2,3,4),
            @(6,1,2,3,4,5)
        )
        expectedDet = -27216
    },
    @{
        size = 6
        matrix = @(
            @(1,2,3,4,5,6),
            @(1,1,2,2,3,3),
            @(6,5,4,3,2,1),
            @(4,4,5,5,6,6),
            @(3,2,1,4,5,6),
            @(7,7,8,8,9,9)
        )
        expectedDet = 0
    },
    @{
        size = 6
        matrix = @(
            @(0,0,2,3,4,0),
            @(0,2,0,0,4,7),
            @(3,4,0,5,0,2),
            @(5,4,7,0,8,6),
            @(0,0,0,1,4,8),
            @(0,5,7,0,0,2)
        )
        expectedDet = 26240
    },
    @{
        size = 6
        matrix = @(
            @(1,3,5,7,9,1),
            @(2,4,6,8,0,2),
            @(3,5,7,9,1,3),
            @(4,6,8,0,2,4),
            @(5,7,9,1,3,5),
            @(6,8,0,2,4,6)
        )
        expectedDet = 0
    },
    @{
        size = 6
        matrix = @(
            @(5,2,1,4,5,6),
            @(4,4,4,3,2,2),
            @(1,3,4,6,4,4),
            @(2,3,6,6,7,3),
            @(5,7,6,0,0,1),
            @(7,7,5,3,2,6)
        )
        expectedDet = -798
    },
    @{
        size = 6
        matrix = @(
            @(4,5,3,7,7,7),
            @(8,8,8,4,3,2),
            @(4,5,3,9,9,9),
            @(3,4,5,5,5,1),
            @(2,1,1,1,9,0),
            @(3,4,5,7,7,1)
        )
        expectedDet = -832
    },
    @{
        size = 7
        matrix = @(
            @(4,2,5,5,6,7,3),
            @(1,4,3,6,7,9,5),
            @(3,5,4,6,7,1,2),
            @(6,4,7,7,4,1,4),
            @(7,5,6,4,4,2,1),
            @(6,3,4,1,2,1,2),
            @(2,3,5,3,6,5,7)
        )
        expectedDet = 26926
    },
    @{
        size = 7
        matrix = @(
            @(1,3,5,4,3,6,5),
            @(2,5,6,5,4,7,5),
            @(3,5,5,7,6,4,3),
            @(1,2,2,4,3,5,6),
            @(5,6,5,4,5,6,4),
            @(2,4,5,4,6,5,3),
            @(8,7,6,5,4,8,6)
        )
        expectedDet = -563
    },
    @{
        size = 7
        matrix = @(
            @(2,3,1,2,3,4,5),
            @(5,6,4,6,7,8,5),
            @(1,2,4,6,7,5,6),
            @(2,5,4,6,5,3,2),
            @(6,5,6,7,4,3,2),
            @(4,5,6,5,7,8,5),
            @(8,5,4,6,4,2,4)
        )
        expectedDet = -9339
    },
    @{
        size = 7
        matrix = @(
            @(7,8,9,8,7,8,9),
            @(8,9,8,7,7,8,9),
            @(7,8,9,9,8,8,7),
            @(7,7,8,9,8,7,8),
            @(7,8,9,8,9,7,9),
            @(9,9,8,7,8,7,7),
            @(7,7,8,9,9,8,8)
        )
        expectedDet = 285
    },
    @{
        size = 7
        matrix = @(
            @(1,2,3,4,5,6,7),
            @(2,3,4,5,6,7,8),
            @(3,4,5,6,7,8,9),
            @(4,5,6,7,8,9,0),
            @(5,6,7,8,9,0,1),
            @(6,7,8,9,0,1,2),
            @(7,8,9,0,1,2,3)
        )
        expectedDet = 0
    },
    @{
        size = 7
        matrix = @(
            @(1,2,3,4,5,6,7),
            @(2,3,4,5,6,7,1),
            @(3,4,5,6,7,1,2),
            @(4,5,6,7,1,2,3),
            @(5,6,7,1,2,3,4),
            @(6,7,1,2,3,4,5),
            @(7,1,2,3,4,5,6)
        )
        expectedDet = -470596
    },
    @{
        size = 7
        matrix = @(
            @(2,3,1,2,3,1,2),
            @(1,3,1,2,3,2,3),
            @(3,2,2,1,3,2,1),
            @(2,3,2,1,2,3,1),
            @(3,2,1,3,2,2,1),
            @(1,2,2,3,1,2,3),
            @(1,2,3,3,3,2,1)
        )
        expectedDet = 296
    },
    @{
        size = 7
        matrix = @(
            @(4,5,6,5,6,5,4),
            @(5,4,5,5,4,5,6),
            @(5,6,4,5,6,4,5),
            @(4,6,5,5,4,5,5),
            @(5,5,5,4,6,5,4),
            @(4,5,6,5,6,4,5),
            @(5,6,5,4,5,6,4)
        )
        expectedDet = 3
    },
    @{
        size = 7
        matrix = @(
            @(0,1,0,0,0,0,0),
            @(5,0,0,0,0,0,0),
            @(0,0,7,0,0,0,0),
            @(0,0,0,0,0,0,6),
            @(0,0,0,4,0,0,0),
            @(0,0,0,0,0,3,0),
            @(0,0,0,0,8,0,0)
        )
        expectedDet = -20160
    },
    @{
        size = 8
        matrix = @(
            @(4,5,4,5,6,7,5,3),
            @(1,2,4,2,4,6,4,3),
            @(3,4,4,5,7,5,4,5),
            @(2,4,4,6,7,4,3,4),
            @(5,4,2,5,7,8,5,3),
            @(1,9,4,2,5,4,5,7),
            @(2,5,3,6,8,9,4,0),
            @(1,6,3,6,8,5,3,6)
        )
        expectedDet = 3049
    },
    @{
        size = 8
        matrix = @(
            @(2,5,4,7,9,4,2,5),
            @(2,4,3,5,7,4,2,5),
            @(7,4,6,4,2,1,3,8),
            @(7,6,3,9,6,4,2,1),
            @(2,4,6,3,7,8,5,3),
            @(6,4,6,8,4,2,6,8),
            @(6,8,0,5,2,6,8,4),
            @(9,5,3,2,3,2,1,2)
        )
        expectedDet = -309864
    },
    @{
        size = 8
        matrix = @(
            @(4,5,6,3,2,4,6,7),
            @(5,3,2,4,6,8,5,3),
            @(9,6,3,4,4,2,6,7),
            @(1,4,6,7,4,3,6,8),
            @(6,4,6,8,1,2,4,6),
            @(4,6,3,6,7,8,4,3),
            @(3,6,8,6,4,2,1,5),
            @(5,3,2,5,7,4,2,5)
        )
        expectedDet = 353418
    },
    @{
        size = 8
        matrix = @(
            @(4,6,8,4,7,3,2,1),
            @(5,7,6,8,9,4,3,6),
            @(8,7,5,3,5,7,8,5),
            @(9,7,5,3,5,7,8,5),
            @(1,5,6,7,8,6,4,6),
            @(7,5,6,7,5,3,6,4),
            @(8,6,3,5,8,9,3,2),
            @(9,7,5,7,8,5,3,6)
        )
        expectedDet = 15300
    },
    @{
        size = 9
        matrix = @(
            @(2,3,4,5,6,5,3,2,1),
            @(4,3,5,6,5,4,3,2,8),
            @(1,3,9,0,8,6,4,3,5),
            @(3,5,4,6,5,3,5,3,2),
            @(6,5,6,7,8,4,3,4,5),
            @(5,6,5,3,2,4,5,6,4),
            @(3,5,6,5,4,3,4,5,6),
            @(6,5,6,7,4,3,2,3,5),
            @(2,3,5,4,6,5,4,3,2)
        )
        expectedDet = -90520
    },
    @{
        size = 9
        matrix = @(
            @(2,5,4,6,5,4,2,4,6),
            @(6,5,3,2,4,6,4,2,4),
            @(5,4,5,6,4,3,5,6,4),
            @(5,6,5,3,2,4,6,7,5),
            @(4,5,6,4,2,4,6,8,5),
            @(4,5,6,7,4,3,5,7,5),
            @(1,1,1,2,3,4,5,6,4),
            @(4,5,4,3,4,5,6,5,3),
            @(4,5,7,0,8,6,5,4,4)
        )
        expectedDet = -15750
    },
    @{
        size = 9
        matrix = @(
            @(3,4,5,6,4,3,2,5,6),
            @(4,5,6,5,4,3,4,5,6),
            @(5,6,7,6,5,6,7,6,5),
            @(7,6,3,4,5,1,2,4,3),
            @(6,5,7,8,7,6,5,4,3),
            @(5,4,5,7,4,5,6,4,2),
            @(2,3,5,7,5,4,3,2,1),
            @(2,4,6,4,3,2,5,6,4),
            @(7,6,5,6,5,3,5,2,1)
        )
        expectedDet = -7515
    },
    @{
        size = 9
        matrix = @(
            @(2,4,6,5,4,5,4,3,2),
            @(5,4,6,5,4,6,8,9,6),
            @(1,5,4,6,5,4,6,7,8),
            @(5,6,7,6,5,4,5,6,7),
            @(6,7,8,7,6,5,4,3,2),
            @(6,7,8,7,6,4,3,2,2),
            @(2,3,5,6,5,4,3,2,4),
            @(6,5,7,6,4,3,2,1,3),
            @(6,5,6,8,5,3,5,6,7)
        )
        expectedDet = -1746
    },
    @{
        size = 9
        matrix = @(
            @(1,2,3,4,5,6,7,8,9),
            @(2,3,4,5,6,7,8,9,1),
            @(3,4,5,6,7,8,9,1,2),
            @(4,5,6,7,8,9,1,2,3),
            @(5,6,7,8,9,1,2,3,4),
            @(6,7,8,9,1,2,3,4,5),
            @(7,8,9,1,2,3,4,5,6),
            @(8,9,1,2,3,4,5,6,7),
            @(9,1,2,3,4,5,6,7,8)
        )
        expectedDet = 215233605
    },
    @{
        size = 9
        matrix = @(
            @(1,2,3,1,2,3,1,2,3),
            @(2,3,4,2,3,4,2,3,4),
            @(3,4,5,3,4,5,3,4,5),
            @(4,5,6,4,5,6,4,5,6),
            @(5,6,7,5,6,7,5,6,7),
            @(6,7,8,6,7,8,6,7,8),
            @(7,8,9,7,8,9,7,8,9),
            @(8,9,1,8,9,1,8,9,1),
            @(9,0,1,9,0,1,9,0,1)
        )
        expectedDet = 0
    },
    @{
        size = 9
        matrix = @(
            @(0,0,0,0,5,0,0,0,0),
            @(4,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,7,0,0),
            @(0,0,1,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,9),
            @(0,0,0,2,0,0,0,0,0),
            @(0,3,0,0,0,0,0,0,0),
            @(0,0,0,0,0,6,0,0,0),
            @(0,0,0,0,0,0,0,8,0)
        )
        expectedDet = 362880
    },
    @{
        size = 9
        matrix = @(
            @(0,2,4,6,5,8,7,6,5),
            @(4,0,4,3,6,8,9,1,2),
            @(6,3,0,1,4,3,6,8,5),
            @(2,4,1,0,5,8,7,3,4),
            @(5,3,5,5,0,1,3,2,9),
            @(6,4,4,2,4,0,6,2,8),
            @(6,3,5,5,6,9,0,5,4),
            @(1,3,8,8,3,6,4,0,2),
            @(2,9,5,6,5,4,3,2,0)
        )
        expectedDet = -8493104
    },
    @{
        size = 9
        matrix = @(
            @(1,2,1,2,1,2,1,2,1),
            @(3,3,2,2,3,3,2,2,3),
            @(1,2,3,1,2,3,1,2,3),
            @(1,1,2,1,1,2,1,1,2),
            @(3,2,2,3,2,2,3,2,2),
            @(1,2,3,3,1,2,3,3,1),
            @(3,2,1,2,3,3,2,1,2),
            @(1,2,3,2,1,2,3,2,1),
            @(2,1,2,3,2,1,2,3,1)
        )
        expectedDet = 0
    },
    @{
        size = 10
        matrix = @(
            @(2,6,7,8,7,6,5,4,6,8),
            @(6,5,2,8,0,4,3,2,5,9),
            @(1,5,3,2,8,6,7,4,3,5),
            @(4,6,7,2,3,5,9,7,6,9),
            @(5,8,6,3,5,8,7,6,5,3),
            @(9,5,4,3,6,7,8,7,5,4),
            @(2,5,7,6,4,9,8,7,5,7),
            @(3,6,5,7,8,7,6,5,4,5),
            @(6,3,4,8,7,6,5,4,9,5),
            @(8,7,6,3,2,4,1,8,6,4)
        )
        expectedDet = 15995040
    },
    @{
        size = 10
        matrix = @(
            @(2,3,4,6,5,7,8,9,5,3),
            @(2,3,4,5,7,6,8,9,7,6),
            @(1,2,5,7,4,6,8,5,3,5),
            @(4,7,5,9,7,4,6,2,3,5),
            @(5,7,8,6,4,5,3,2,4,5),
            @(1,2,3,6,7,8,6,5,4,3),
            @(5,7,9,7,5,5,3,2,1,1),
            @(0,7,6,8,5,4,3,5,6,4),
            @(4,7,6,5,8,7,5,6,4,5),
            @(1,3,4,3,5,4,5,4,2,7)
        )
        expectedDet = -866596
    },
    @{
        size = 10
        matrix = @(
            @(5,8,4,4,6,5,7,7,1,2),
            @(3,6,7,5,8,9,0,5,3,6),
            @(1,4,5,4,6,7,8,5,4,6),
            @(1,4,6,5,7,6,8,7,6,5),
            @(3,6,5,7,6,8,7,6,4,6),
            @(4,7,6,8,7,6,5,6,4,6),
            @(9,8,9,9,5,4,1,4,3,4),
            @(1,2,4,3,4,2,2,8,9,0),
            @(4,5,6,3,7,8,6,5,7,3),
            @(9,5,7,6,1,5,4,5,7,5)
        )
        expectedDet = -1263828
    },
    @{
        size = 10
        matrix = @(
            @(6,4,2,5,6,3,7,2,1,3),
            @(4,7,4,1,7,5,8,9,0,3),
            @(2,5,6,7,4,8,4,2,5,7),
            @(1,4,6,4,7,9,5,7,9,5),
            @(1,4,7,9,5,3,6,8,5,7),
            @(3,6,4,6,8,5,8,6,8,6),
            @(6,5,7,8,5,7,5,3,2,5),
            @(5,6,7,4,6,8,0,4,7,8),
            @(2,5,6,8,8,9,6,4,6,3),
            @(3,5,7,5,7,8,6,8,5,7)
        )
        expectedDet = -653224
    },
    @{
        size = 10
        matrix = @(
            @(1,2,3,4,5,6,7,8,9,0),
            @(2,3,4,5,6,7,8,9,0,1),
            @(3,4,5,6,7,8,9,0,1,2),
            @(4,5,6,7,8,9,0,1,2,3),
            @(5,6,7,8,9,0,1,2,3,4),
            @(6,7,8,9,0,1,2,3,4,5),
            @(7,8,9,0,1,2,3,4,5,6),
            @(8,9,0,1,2,3,4,5,6,7),
            @(9,0,1,2,3,4,5,6,7,8),
            @(1,1,1,1,1,1,1,1,1,1)
        )
        expectedDet = 100000000
    },
    @{
        size = 10
        matrix = @(
            @(1,0,0,0,0,0,0,0,0,0),
            @(0,2,0,0,0,0,0,0,0,0),
            @(0,0,3,0,0,0,0,0,0,0),
            @(0,0,0,4,0,0,0,0,0,0),
            @(0,0,0,0,5,0,0,0,0,0),
            @(0,0,0,0,0,6,0,0,0,0),
            @(0,0,0,0,0,0,7,0,0,0),
            @(0,0,0,0,0,0,0,8,0,0),
            @(0,0,0,0,0,0,0,0,9,0),
            @(0,0,0,0,0,0,0,0,0,1)
        )
        expectedDet = 362880
    },
    @{
        size = 10
        matrix = @(
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0),
            @(1,2,3,4,5,6,7,8,9,0)
        )
        expectedDet = 0
    },
    @{
        size = 10
        matrix = @(
            @(1,1,1,1,1,1,1,1,1,1),
            @(2,2,2,2,2,2,2,2,2,2),
            @(3,3,3,3,3,3,3,3,3,3),
            @(4,4,4,4,4,4,4,4,4,4),
            @(5,5,5,5,5,5,5,5,5,5),
            @(6,6,6,6,6,6,6,6,6,6),
            @(7,7,7,7,7,7,7,7,7,7),
            @(8,8,8,8,8,8,8,8,8,8),
            @(9,9,9,9,9,9,9,9,9,9),
            @(1,1,1,1,1,1,1,1,1,1)
        )
        expectedDet = 0
    },
    @{
        size = 10
        matrix = @(
            @(0,0,1,1,4,5,7,4,5,6),
            @(1,0,0,2,2,4,6,8,6,5),
            @(3,4,0,0,3,3,7,9,8,7),
            @(0,0,2,7,6,5,6,8,8,1),
            @(5,6,7,8,6,5,8,8,0,0),
            @(5,7,6,0,0,5,4,3,3,9),
            @(4,5,4,4,7,6,5,0,0,5),
            @(3,5,0,0,7,8,4,3,7,9),
            @(9,9,2,3,5,6,0,0,1,2),
            @(3,4,5,6,4,1,1,7,0,0)
        )
        expectedDet = 11183126
    },
    @{
        size = 8
        matrix = @(
            @(1,2,3,4,5,6,7,8),
            @(2,3,4,5,6,7,8,1),
            @(3,4,5,6,7,8,1,2),
            @(4,5,6,7,8,1,2,3),
            @(5,6,7,8,1,2,3,4),
            @(6,7,8,1,2,3,4,5),
            @(7,8,1,2,3,4,5,6),
            @(8,1,2,3,4,5,6,7)

        )
        expectedDet = 9437184
    },
    @{
        size = 8
        matrix = @(
            @(1,2,3,1,2,3,1,2),
            @(2,3,4,2,3,4,2,3),
            @(3,4,5,3,4,5,3,4),
            @(4,5,6,4,5,6,4,5),
            @(5,6,7,5,6,7,5,6),
            @(6,7,8,6,7,8,6,7),
            @(7,8,9,7,8,9,7,8),
            @(9,0,1,9,0,1,9,0)

        )
        expectedDet = 0
    },
    @{
        size = 8
        matrix = @(
            @(0,0,0,0,4,5,6,4),
            @(1,2,3,4,0,0,0,0),
            @(2,0,0,0,0,1,2,3),
            @(5,6,7,0,0,0,0,7),
            @(2,3,0,0,0,0,3,2),
            @(5,5,7,7,0,0,0,0),
            @(2,0,0,0,0,2,3,4),
            @(5,4,3,0,0,0,0,1)

        )
        expectedDet = 2736
    },
    @{
        size = 8
        matrix = @(
            @(2,3,3,3,4,6,4,4),
            @(6,6,6,5,3,3,3,2),
            @(5,5,6,7,6,6,5,3),
            @(2,2,4,5,6,6,5,4),
            @(5,9,0,0,7,7,6,7),
            @(3,4,5,3,4,2,2,1),
            @(2,2,2,3,8,7,8,8),
            @(4,5,5,4,4,3,2,1)

        )
        expectedDet = 248
    },
    @{
        size = 8
        matrix = @(
            @(5,4,3,4,5,5,4,3),
            @(5,6,5,4,5,6,5,7),
            @(7,6,4,4,3,2,3,5),
            @(2,3,4,3,3,2,3,2),
            @(7,6,7,8,7,6,7,8),
            @(1,2,1,0,2,2,1,2),
            @(1,2,1,2,1,3,4,5),
            @(3,3,3,2,2,2,1,1)

        )
        expectedDet = -360
    },
    @{
        size = 10
        matrix = @(
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0),
            @(0,0,0,0,0,0,0,0,0,0)
        )
        expectedDet = 0
    }
)

#Write-Host (Get-Location)
$successCount = 0
$errorCount = 0
$buggyValueCount = 0
foreach ($test in $tests) {
    $timeLimit = -1
    if($test.timeLimit){
        $timeLimit = $test.timeLimit
    }

    $res = Test-MatrixDeterminant -size $test.size -matrix $test.matrix -expectedDet $test.expectedDet -timeLimit $timeLimit
    if($res -eq 1){
        $successCount += 1
    }
    elseif($res -eq 0)
    {
        $errorCount += 1
    }
    else
    {
        $buggyValueCount += 1
    }
}

Write-Host "Success Count $successCount" -ForegroundColor Green
Write-Host "Error Count $errorCount" -ForegroundColor Red
Write-Host "Bug Value Count $buggyValueCount" -ForegroundColor Cyan